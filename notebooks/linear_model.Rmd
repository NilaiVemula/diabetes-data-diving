---
title: "Model Building"
output: html_notebook
---

# Loading in Data

This notebook will be focused on building a predictive model from the dataset. The response variable is class, and all other variables are predictors. All predictors are categorical except for Age which is a ordinal variable.

```{r}
require(tidyverse)

data <- read_csv("../data/clean_numeric_data.csv")
data
```

# chi square feature selection


Polyuria	227.86583895			
Polydipsia	216.17163270			
Gender	103.03685928			
sudden weight loss	97.29630348			
partial paresis	95.38762744	

# building the linear model

```{r}
model <- lm(class ~ Age + Gender + Polyuria + Polydipsia + sudden.weight.loss + partial.paresis, data=data)

summary(model)
par(mfrow=c(2,2))
plot(model)
```
MSPE:

```{r}
mean(model$residual^2)
```


$R^2$:

```{r}
summary(model)$r.squared 
```


Residual Plot:

```{r}
mod_results <- data.frame(observed = data$class, predicted = model$fitted.values, residual = model$residuals)
head(mod_results)
```

```{r}
ggplot(mod_results, aes(y = residual, x = predicted)) + 
    geom_point() + 
    geom_hline(yintercept = 0) +
      theme_bw() +
  labs(title="Residual Plot", x="Predicted", y="Residual") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(plot.background = element_rect(fill = '#f2f2f2', colour = '#f2f2f2')) +
  theme(panel.background = element_rect(fill = '#f2f2f2', colour = '#f2f2f2'))
ggsave("../plots/residual_plot.png", dpi = 1200, width = 4, height = 4, units = "in")
```


Q-Q Plot:
```{r}
ggplot(mod_results, aes(sample = residual)) + 
    geom_qq()+
  geom_qq_line() +
  theme_bw() +
  labs(title="Q-Q Plot", x="Theoretical Quantile", y="Sample Quantile") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(plot.background = element_rect(fill = '#f2f2f2', colour = '#f2f2f2')) +
  theme(panel.background = element_rect(fill = '#f2f2f2', colour = '#f2f2f2'))
ggsave("../plots/qq_plot.png", dpi = 1200, width = 4, height = 4, units = "in")
```


```{r}
mean_res <- mean(mod_results$residual)
sd_res <- sd(mod_results$residual)
print(c(mean_res, sd_res))
```
