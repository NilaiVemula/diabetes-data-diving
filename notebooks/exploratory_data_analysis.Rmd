---
title: "Exploratory Data Analysis"
output: html_notebook
---

# Importing Required Libraries

```{r}
require(tidyverse)
```

# Loading in Data

```{r}
data <- read_csv("../data/diabetes_data_upload.csv")
data
```

```{r}
data %>% select(class) %>% filter(class == "Positive") %>% summarise(n())
```
```{r}
data %>% select(class) %>% filter(class == "Negative") %>% summarise(n())
```

```{r}
data %>% 
  ggplot(aes(x=class)) +
  geom_bar()
```


We have 320 positive and 200 negative patients.


```{r}
colnames(data)
```
The response variable is class, and all other variables are predictors. All predictors are categorical except for Age which is a ordinal variable.

# Correlation Plot

```{r}
# replcaing categorical labels to numeric ones
data_clean <- data.frame(lapply(data, function(x) {
                  gsub("Yes", "1", x)
              }))

data_clean <- data.frame(lapply(data_clean, function(x) {
                  gsub("No", "0", x)
              }))

data_clean <- data.frame(lapply(data_clean, function(x) {
                  gsub("Positive", "1", x)
              }))

data_clean <- data.frame(lapply(data_clean, function(x) {
                  gsub("Negative", "0", x)
              }))

data_clean <- data.frame(lapply(data_clean, function(x) {
                  gsub("Male", "0", x)
              }))

data_clean <- data.frame(lapply(data_clean, function(x) {
                  gsub("Female", "1", x)
              }))

# converting all columns to numeric
data_clean <- data.frame(sapply( data_clean, as.numeric ))


data_clean

write_csv(data_clean, path="../data/clean_numeric_data.csv")
```


```{r}
require(ggcorrplot)

corr <- round(cor(data_clean),2)
corr
```
```{r}
ggcorrplot(corr)
```


# Diabetes vs Age

```{r}
data %>% 
  ggplot(aes(x=Age, fill=class)) +
  geom_density(alpha=0.2)
```


There does not appear to be a very large difference in diabetes status based on age.

# Diabetes vs Gender

```{r}
data %>% 
  ggplot(aes(x=Gender, fill=class)) +
  geom_bar()
```

## chi square test of independence

h0: gender and diabetes status are independent

h1: not independent

```{r}
table(data$Gender, data$class)
```
```{r}
test <- chisq.test(table(data$Gender, data$class))
test
```

```{r}
test$expected
```
With a p-value < 2.2e-16, we reject our null hypothesis at all significance levels and conclude that gender and diabetes class are not independent.




